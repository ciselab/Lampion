version: '3.8'

services:
  {% for config in configurations -%}
  CodeBert_Preprocessing_{{ config.run_number }}:
    image: lampion/codebert-preprocessing:latest
    volumes:
      - ./ur_dataset:/raw_data:ro
      - {{ config.path_to }}/dataset:/data
      - {{ config.path_to }}:/config:ro
    environment:
      RAW_DATA_FILE: {{ config.test_file|default("test_java.jsonl",true) }}
      POST_ALTERNATION_JSONL: {{ config.test_file|default("preprocessed_test_java.jsonl",true) }}

  {% endfor %}